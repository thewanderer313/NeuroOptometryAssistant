<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Anisocoria Module</title>
  <link rel="stylesheet" href="./assets/styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <h1>Neuro-Ophtho Assistant</h1>
      <p class="sub">Modules share one live clinical session • persistent differential</p>
    </div>
    <div class="pill">Local • No network calls</div>
  </header>

  <div class="tabbar">
    <nav class="tabbarInner">
      <a href="./index.html">Home</a>
      <a href="./anisocoria.html">Anisocoria</a>
      <a href="./eom.html">EOM / Lesion</a>
      <a href="./visual-fields.html">Visual Fields</a>
    </nav>
  </div>

  <div class="shell">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="nav">
        <a href="./anisocoria.html">Anisocoria</a>
        <a href="./eom.html">EOM / Lesion</a>
        <a href="./visual-fields.html">Visual Fields</a>
      </div>

      <section class="card" id="section-optic">
        <h2>Session</h2>
        <div class="small"><strong id="sbPatient">Untitled</strong></div>
        <div class="small" id="sbUpdated"></div>

        <h3>Pupil pattern</h3>
        <div class="small">Anisocoria (Light): <strong id="sbAnisL">—</strong></div>
        <div class="small">Anisocoria (Dark): <strong id="sbAnisD">—</strong></div>
        <div class="small">Pattern: <strong id="sbPattern">—</strong></div>

        <div class="btnRow">
          <button class="ghost" id="sbReset">Reset session</button>
        </div>
        </div>
        </div>
      </section>

      <section class="card">
        <h2>Urgency</h2>
        <div class="callout" id="sbUrgency" data-level="none">—</div>
      </section>

      <section class="card">
        <h2>Top Differential</h2>
        <div id="sbDx"></div>
      </section>

      <section class="card">
        <h2>Recommended Testing</h2>
        <div id="sbTests"></div>
      </section>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <section class="card">
        <h2>Anisocoria / Pupils</h2>

        <!-- In-page tab navigation -->
        <div class="page-tabs">
          <button class="page-tab active" data-tab="measurements">Measurements</button>
          <button class="page-tab" data-tab="signs">Signs & RAPD</button>
          <button class="page-tab" data-tab="optic">Optic Nerve</button>
          <button class="page-tab" data-tab="presets">Presets</button>
        </div>

        <!-- Tab: Measurements -->
        <div class="tab-content active" id="tab-measurements">
          <!-- Triage alerts -->
          <div class="triage-bar">
            <span class="triage-label">Triage flags:</span>
            <label class="triage-chip"><input type="checkbox" id="acuteOnset"> Acute</label>
            <label class="triage-chip"><input type="checkbox" id="painful"> Pain</label>
            <label class="triage-chip"><input type="checkbox" id="neuroSx"> Neuro Sx</label>
            <label class="triage-chip"><input type="checkbox" id="trauma"> Trauma</label>
          </div>

          <!-- Visual Pupil Diagram -->
          <div class="pupil-entry-section">
            <div class="pupil-diagram-compact">
              <div class="eye-container">
                <div class="eye-label">OD (Right)</div>
                <div class="eye" id="eyeOD">
                  <div class="iris">
                    <div class="pupil" id="pupilOD"></div>
                  </div>
                </div>
                <div class="pupil-size-display" id="pupilSizeOD">-- mm</div>
              </div>
              <div class="eye-container">
                <div class="eye-label">OS (Left)</div>
                <div class="eye" id="eyeOS">
                  <div class="iris">
                    <div class="pupil" id="pupilOS"></div>
                  </div>
                </div>
                <div class="pupil-size-display" id="pupilSizeOS">-- mm</div>
              </div>
            </div>

            <div class="lighting-toggle">
              <button class="lighting-btn active" id="lightingLight">Light</button>
              <button class="lighting-btn" id="lightingDark">Dark</button>
            </div>

            <!-- Measurement inputs - side by side -->
            <div class="measurement-grid">
              <div class="measurement-group">
                <h4>In Light</h4>
                <div class="input-row">
                  <label class="compact-label">
                    OD
                    <input type="number" step="0.1" min="0" max="12" id="odLight" placeholder="3.0" inputmode="decimal">
                  </label>
                  <label class="compact-label">
                    OS
                    <input type="number" step="0.1" min="0" max="12" id="osLight" placeholder="3.0" inputmode="decimal">
                  </label>
                </div>
                <div class="aniso-readout">
                  Anisocoria: <strong id="anisLight">--</strong>
                </div>
              </div>

              <div class="measurement-group">
                <h4>In Dark</h4>
                <div class="input-row">
                  <label class="compact-label">
                    OD
                    <input type="number" step="0.1" min="0" max="12" id="odDark" placeholder="5.0" inputmode="decimal">
                  </label>
                  <label class="compact-label">
                    OS
                    <input type="number" step="0.1" min="0" max="12" id="osDark" placeholder="5.0" inputmode="decimal">
                  </label>
                </div>
                <div class="aniso-readout">
                  Anisocoria: <strong id="anisDark">--</strong>
                </div>
              </div>
            </div>

            <!-- Reactivity -->
            <div class="reactivity-row">
              <label class="compact-label">
                OD Reaction
                <select id="odLightRxn">
                  <option value="">--</option>
                  <option value="brisk">Brisk</option>
                  <option value="sluggish">Sluggish</option>
                  <option value="none">Fixed</option>
                </select>
              </label>
              <label class="compact-label">
                OS Reaction
                <select id="osLightRxn">
                  <option value="">--</option>
                  <option value="brisk">Brisk</option>
                  <option value="sluggish">Sluggish</option>
                  <option value="none">Fixed</option>
                </select>
              </label>
            </div>
          </div>

          <!-- Guidance panel -->
          <div class="guidance-panel">
            <div class="guidance-item">
              <span class="guidance-label">Pattern</span>
              <span class="guidance-value" id="pupilLocalize">Enter measurements</span>
            </div>
            <div class="guidance-item">
              <span class="guidance-label">Next step</span>
              <span class="guidance-value" id="pupilNext">--</span>
            </div>
          </div>
        </div>

        <!-- Tab: Signs & RAPD -->
        <div class="tab-content" id="tab-signs">
          <h3>RAPD (Relative Afferent Pupillary Defect)</h3>
          <div class="input-row">
            <label class="compact-label">
              RAPD OD
              <select id="rapdOD">
                <option value="">--</option>
                <option value="none">None</option>
                <option value="1+">1+ (trace)</option>
                <option value="2+">2+ (mild)</option>
                <option value="3+">3+ (moderate)</option>
                <option value="4+">4+ (severe)</option>
              </select>
            </label>
            <label class="compact-label">
              RAPD OS
              <select id="rapdOS">
                <option value="">--</option>
                <option value="none">None</option>
                <option value="1+">1+ (trace)</option>
                <option value="2+">2+ (mild)</option>
                <option value="3+">3+ (moderate)</option>
                <option value="4+">4+ (severe)</option>
              </select>
            </label>
          </div>

          <h3>Pupillary Signs</h3>
          <div class="checkbox-grid">
            <label class="check"><input type="checkbox" id="dilationLag"> Dilation lag</label>
            <label class="check"><input type="checkbox" id="anhidrosis"> Anhidrosis</label>
            <label class="check"><input type="checkbox" id="lightNearDissociation"> Light-near dissociation</label>
            <label class="check"><input type="checkbox" id="vermiform"> Vermiform movements</label>
          </div>

          <h3>Drug Exposure</h3>
          <div class="checkbox-grid">
            <label class="check"><input type="checkbox" id="anticholinergicExposure"> Anticholinergic</label>
            <label class="check"><input type="checkbox" id="sympathomimeticExposure"> Sympathomimetic</label>
          </div>
        </div>

        <!-- Tab: Optic Nerve -->
        <div class="tab-content" id="tab-optic">
          <h3>Disc Appearance</h3>
          <div class="eye-findings-grid">
            <div class="eye-findings-col">
              <h4>OD (Right)</h4>
              <label class="check"><input type="checkbox" id="discPallorOD"> Disc pallor</label>
              <label class="check"><input type="checkbox" id="discEdemaOD"> Disc edema</label>
              <label class="check"><input type="checkbox" id="colorDeficitOD"> Color deficit</label>
              <label class="check"><input type="checkbox" id="vaReducedOD"> VA reduced</label>
            </div>
            <div class="eye-findings-col">
              <h4>OS (Left)</h4>
              <label class="check"><input type="checkbox" id="discPallorOS"> Disc pallor</label>
              <label class="check"><input type="checkbox" id="discEdemaOS"> Disc edema</label>
              <label class="check"><input type="checkbox" id="colorDeficitOS"> Color deficit</label>
              <label class="check"><input type="checkbox" id="vaReducedOS"> VA reduced</label>
            </div>
          </div>

          <h3>Additional Findings</h3>
          <div class="checkbox-grid">
            <label class="check"><input type="checkbox" id="optociliaryShunts"> Optociliary shunts</label>
            <label class="check"><input type="checkbox" id="cupping"> Disc cupping</label>
            <label class="check"><input type="checkbox" id="discHemorrhages"> Disc hemorrhages</label>
          </div>

          <label class="full">
            <span>Notes</span>
            <textarea id="opticNerveNotes" rows="2" placeholder="Additional observations..."></textarea>
          </label>

          <div class="guidance-panel">
            <div class="guidance-item full-width">
              <span class="guidance-label">Optic Nerve Status</span>
              <span class="guidance-value" id="opticNerveStatus">No findings entered</span>
            </div>
          </div>
        </div>

        <!-- Tab: Presets -->
        <div class="tab-content" id="tab-presets">
          <p class="section-desc">Quick-fill common clinical patterns for testing or demonstration.</p>

          <h3>Pupil Patterns</h3>
          <div class="preset-grid">
            <button class="preset-btn" id="presetPhysiologic" title="Normal variant">
              <span class="preset-icon">≈</span>
              <span class="preset-label">Physiologic</span>
            </button>
            <button class="preset-btn" id="presetHorner" title="Small pupil pattern">
              <span class="preset-icon">◐</span>
              <span class="preset-label">Horner</span>
            </button>
            <button class="preset-btn" id="presetCN3" title="Large pupil + ptosis">
              <span class="preset-icon">◑</span>
              <span class="preset-label">CN III</span>
            </button>
            <button class="preset-btn" id="presetAdie" title="Light-near dissociation">
              <span class="preset-icon">○</span>
              <span class="preset-label">Adie</span>
            </button>
            <button class="preset-btn" id="presetPharmaco" title="Fixed dilated">
              <span class="preset-icon">●</span>
              <span class="preset-label">Pharmacologic</span>
            </button>
          </div>

          <h3>Optic Nerve Patterns</h3>
          <div class="preset-grid">
            <button class="preset-btn" id="presetAION" title="RAPD + disc edema">
              <span class="preset-icon">⊖</span>
              <span class="preset-label">AION</span>
            </button>
            <button class="preset-btn" id="presetOpticNeuritis" title="RAPD + pain">
              <span class="preset-icon">⊘</span>
              <span class="preset-label">Optic Neuritis</span>
            </button>
            <button class="preset-btn" id="presetPapilledema" title="Bilateral disc edema">
              <span class="preset-icon">⊛</span>
              <span class="preset-label">Papilledema</span>
            </button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <footer class="footer">Tip: open EOM in a second tab — both pages stay synchronized through the shared session.
  </footer>

  <script type="module" src="./js/anisocoria.page.js"></script>
</body>

</html>
